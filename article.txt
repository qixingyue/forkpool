用php构建一个进程池

看完此文，谁也别跟我说php不能直接操作内存。

编写运行本文中相关的代码需要pcntl，shomp扩展，第一个是多进程相关，第二个是共享内存相关。


简单的多进程程序，只是单纯的利用pcntl_fork出子进程，然后就由子进程自己去处理。
这种情况的缺点：

1. 各个子进程的执行进度不同，不方便获取总得执行进度.
2. 任务动态方便不可实现,造成的影响时，有的进程任务执行特别快，执行完，子进程就自行退出了。
3. 子进程之间不大方便控制,比如当系统资源有限需要自行减少子进程的数目时，不方便控制.
4. 间断性不可控制，意味着，这次程序一次跑完，如果间断，重拾之前的轨迹不大方便

这种方法的实现，请参考文章:
(为方便讨论，这种简单的多进程程序称为A方法)

今天要说的进程池，可以解决上述的四个缺点：
基本思路如下：


当前进程不退出，与A方法产生子进程以后，自行退出不同.
A 方法不需要分配任务，当子进程产生的时候,任务量已经确定.

具体代码如下：
